import{scanDirectives as r,filterSchema as i,walkThroughHandler as s}from"./lib/engine.js";var e=new Object;e.init=(e=null)=>{if(!e||!e.app)throw new Error("No app detected.");new a(e)};const a=class{constructor(e=null){e.app.set("syntaxeEnabledStatus",e.enabled),e.app.use(this.#request)}async#request(e,s,a){var{resolve:t,schema:n}=r(e,s),e=e.app.get("syntaxeEnabledStatus");s.set("Syntaxe-Enabled",e),e&&t&&(s.syntaxeSchema=await i(n),s.syntaxeSchema.status?new o(s):(s.set("Syntaxe-Schema-Resolved",!1),s.set("Syntaxe-Schema-Resolved-Error","Query failed. Check your schema and try again."))),a()}},o=class{#response;#data;#send;constructor(e){this.#response=e,this.#send=this.#response.send,this.#response.send=this.#delegate()}#delegate(){return async e=>{this.#data=await s({data:e,res:this.#response})??e,this.#respond()}}#respond(){this.#send.call(this.#response,this.#data)}};export{e as SyntaxeIO};